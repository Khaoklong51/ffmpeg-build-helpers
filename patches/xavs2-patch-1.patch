From 3b463ea66f196b941e8fe608a4f6d33c4acc99a6 Mon Sep 17 00:00:00 2001
From: Biswapriyo Nath <nathbappai@gmail.com>
Date: Fri, 14 Apr 2023 01:58:56 +0530
Subject: [PATCH 1/3] encoder: cast function pointer type

---
 source/encoder/encoder.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/source/encoder/encoder.c b/source/encoder/encoder.c
index d5b3890..3611ac3 100644
--- a/source/encoder/encoder.c
+++ b/source/encoder/encoder.c
@@ -2038,7 +2038,7 @@ void *xavs2e_encode_one_frame(void *arg)
 
     /* start AEC frame coding */
     if (h->h_top->threadpool_aec != NULL && !h->param->enable_alf) {
-        xavs2_threadpool_run(h->h_top->threadpool_aec, encoder_aec_encode_one_frame, h, 0);
+        xavs2_threadpool_run(h->h_top->threadpool_aec, (xavs2_tfunc_t)encoder_aec_encode_one_frame, h, 0);
     }
 
     /* (3) encode all LCU rows in current frame ---------------------------
@@ -2147,7 +2147,7 @@ void *xavs2e_encode_one_frame(void *arg)
 #endif
 
         if (h->h_top->threadpool_aec != NULL) {
-            xavs2_threadpool_run(h->h_top->threadpool_aec, encoder_aec_encode_one_frame, h, 0);
+            xavs2_threadpool_run(h->h_top->threadpool_aec, (xavs2_tfunc_t)encoder_aec_encode_one_frame, h, 0);
         }
     }
 

From 79a6833b4a093f5148913071f5ecfb4c30fa3c34 Mon Sep 17 00:00:00 2001
From: Christopher Degawa <ccom@randomderp.com>
Date: Thu, 16 May 2024 10:02:40 -0500
Subject: [PATCH 2/3] parameters: replace chinese with utf8 equivalent

Signed-off-by: Christopher Degawa <ccom@randomderp.com>
---
 source/encoder/parameters.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/source/encoder/parameters.c b/source/encoder/parameters.c
index 9adec5b..abc1e95 100644
--- a/source/encoder/parameters.c
+++ b/source/encoder/parameters.c
@@ -207,7 +207,7 @@ mapping_default(xavs2_param_map_t *p_map_tab, xavs2_param_t *p)
     MAP("ALFLowLatencyEncodingEnable",  &p->alf_LowLatencyEncoding,     MAP_NUM, "Enable Low Latency ALF (1=Low Latency mode, 0=High Efficiency mode)");
     MAP("CrossSliceLoopFilter",         &p->b_cross_slice_loop_filter,  MAP_NUM, "Enable Cross Slice Boundary Filter (0=Disable, 1=Enable)");
 
-    /* ��������� */
+    /* 场编码参数 */
     // MAP("InterlaceCodingOption",        &p->InterlaceCodingOption,      MAP_NUM);
     // MAP("RepeatFirstField",             &p->repeat_first_field,         MAP_NUM);
     // MAP("TopFieldFirst",                &p->top_field_first,            MAP_NUM);
@@ -425,7 +425,7 @@ int ParameterNameToMapIndex(xavs2_param_map_t *p_map_tab, const char *param_name
     mapping_t *map_tab = p_map_tab->map_tab;
     int i = 0;
 
-    while (map_tab[i].name[0] != '\0') {  // ��ֹλ���ǿ��ַ���
+    while (map_tab[i].name[0] != '\0') {  // 终止位置是空字符串
         if (xavs2_param_match(map_tab[i].name, param_name)) {
             return i;
         } else {

From 7cb09181241db5b2b0e743058b5e28a1802ff93d Mon Sep 17 00:00:00 2001
From: Christopher Degawa <ccom@randomderp.com>
Date: Thu, 16 May 2024 10:21:22 -0500
Subject: [PATCH 3/3] xavs2_get_configs: change argv type to match caller

gcc 14 changes incompatible-pointer-types to an error:

```c
source/encoder/parameters.c: In function 'xavs2_encoder_opt_set':
source/encoder/parameters.c:632:45: error: passing argument 2 of 'xavs2_get_configs' from incompatible pointer type [-Wincompatible-pointer-types]
  632 |     if ((contents = xavs2_get_configs(argc, argv)) == NULL) {
      |                                             ^~~~
      |                                             |
      |                                             char **
source/encoder/parameters.c:531:62: note: expected 'const char * const*' but argument is of type 'char **'
  531 | static char *xavs2_get_configs(int argc, const char * const *argv)
      |                                          ~~~~~~~~~~~~~~~~~~~~^~~~
```

Signed-off-by: Christopher Degawa <ccom@randomderp.com>
---
 source/encoder/parameters.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/source/encoder/parameters.c b/source/encoder/parameters.c
index abc1e95..306f822 100644
--- a/source/encoder/parameters.c
+++ b/source/encoder/parameters.c
@@ -528,7 +528,7 @@ char *copy_parameter(char *dst, const char *src)
  *          : less than 2M bytes
  * ---------------------------------------------------------------------------
  */
-static char *xavs2_get_configs(int argc, const char * const *argv)
+static char *xavs2_get_configs(int argc, char *argv[])
 {
     const int size_file_max = 1 << 20; // 1MB
     char item[4096];
